---
title: "Working with Primary data"
subtitle: "`cori.data.fcc`:: an example of data as code"
author: "Olivier Leroy"
date: "October 20 2024"
institute: "Center On Rural Innovation"
fontsize: 20pt
favicon: assets/images/Logo-Mark_Black.png
format:
  revealjs: 
    theme: src/custom_cori.scss
    logo: img/CORI_Logo.png
    css: assets/fonts.css
    footnotes-hover:: true
from: markdown+emoji
editor: visual
---


## PLAN

* Presentation (Me & CORI)

* FCC's Data

 
## :wave: Hi, I am Olivier 

- Socials: [LinkedIn](https://www.linkedin.com/in/olivier-leroy-r/) | [Mastodon](https://fosstodon.org/@defuneste) | [Personal Website](https://branchtwigleaf.com/about.html) 

![Source: [Harvard Business Review](https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century)](img/hbrsexiestjob.png){width=800} 

- Not a Data Scientist but Data Engineer and Working with primary data: "messy, unstructured data" is on us now    

## Slides are online: 

Realized in [Quarto](https://quarto.org/) (reavealjs) hosted in [GitHub](https://github.com/ruralinnovation/conf_URISA_2023)

![](img/qr.svg){height="300" fig-align="center"}

[https://ruralinnovation.github.io/prez_auber_2024/#/title-slide](https://ruralinnovation.github.io/conf_URISA_2023/#/title-slide)


## Center On Rural Innovation ([CORI](https://ruralinnovation.us/))

*Advancing economic prosperity in rural America through the creation of inclusive tech economy ecosystem that support scalable entrepreneurship and tech job creation*

![](img/cori_triangle.png){fig-align="center"}

1. Broadband Infrastucture is part of it

2. Rural data: Need to go back to primary data  

# FCC's Data

## Federal Communications Commission ([FCC](https://www.fcc.gov/)) 

- Agency in charge of regulating "everything" communications

- Lot of useful datasets

- Their data landscape is evolving fast (now they have a [platform](https://opendata.fcc.gov/)!)


|                      | [Form 477](https://www.fcc.gov/economics-analytics/industry-analysis-division/form-477-resources)             | [National Broadband Map](https://broadbandmap.fcc.gov/home)                                                                                                                                                                                                                              |
|-------------------------|------------------------|------------------------|
| US Census Boundaries | 2010             | 2020                                                                                                                                                                                                                                 |
| Type of recording    | self declarative | self declarative                                                                                                                                                                                                                     |
| Granularity          | Census blocks     | [Locations](https://broadbandmap.fcc.gov/location-summary/fixed?version=dec2022&location_id=1350199199&addr1=390+MORGAN+ST&addr2=OBERLIN%2C+OH+44074&zoom=15.00&vlon=-82.231744&vlat=41.287448&br=r&speed=25_3&tech=1_2_3_4_5_6_7_8) |
| Services             | Mobile/**Fixed** | Mobile/**Fixed**  |
| Releases | 2014-2021 | 2022 - *Ongoing* |


## Previous workflow:

- What FCC data look like in the wild
- Our previous ingestion process
- Limits of it

ELT versus ETL and what that means for business perspective 

data as files data as tables and the limit 

(out of sync tables/files)

## Our needs

Connect humanity project / BEAD tool 

-> how do we produced that

Importance of using PG

## Manual v.s. ...

:::: {.columns}

::: {.column width="50%"}

![](img/manual_fcc.mov)


:::

::: {.column width="50%"}

* :repeat: Repeat for every state  
* :repeat: Repeat for every version  
* :red_circle: Error prone 

:::

::::


## ... Code Automated ...

:::: {.columns}

::: {.column width="50%"}

::: {.panel-tabset}

### Visual

![](img/dl_nbm_smaller.mov)

### Code

```{r}
#| label: example_dl_nbm
#| eval: false
#| echo: true
library(cori.data.fcc)

dir <- "data_swamp/nbm/"

get_nbm_release()

nbm_data <- get_nbm_available()

system(sprintf("mkdir -p %s", dir))

dl_nbm(
  path_to_dl = "data_swamp/nbm",
  release_date = "June 30, 2023",
  data_type = "Fixed Broadband",
  data_category = "Nationwide",
)

```

:::

:::

::: {.column width="50%"}

```{r}
#| label: check_dl_2
#| eval: false
#| echo: true
num_files <- get_nbm_available() |>
  dplyr::filter(release == "June 30, 2023" &
                data_type == "Fixed Broadband" &
                data_category == "Nationwide") |>
  nrow()

files_dl <- length(list.files(dir,
                              pattern = "*.zip"))

identical(num_files, files_dl)
# TRUE
```

:::

::::

## ... Code Packaged

# cori.data.fcc

## New technologies

- DuckDB and S3

  - takewaysa of those technology

- Parquet and interoperability 

skip PG here. 


## Packaging code and data

tl:dr R package / pkgdown / GH

- `?get_nbm_raw` 

- articles

- vignettes / mention of Emily R interbal package

- snipped of data-raw

- bandwagon pkg dev: test/website/check/distribution  

>  internally developed packages are [...] extra expert team members.[^dataanalysisreuse]

[^dataanalysisreuse]: https://milesmcbain.xyz/posts/data-analysis-reuse/

## why public

- open source is :

* a way to publish: ie you can read the code 

* a way to share: ie you can use it

We care more about process than product or to say it differently the product is just a mean to reach a goal (a process). We want to lower the cost of using that data so rural america can check what their isp are saying and challenge it and plan to get a better bb.




# Examples of uses cases

## How to get it: 

The source code is hosted on GitHub. 

You need the R packages remotes (or pak)

```{r}
#| eval: false
#| label: install-package
#| echo: true
 
install.packages("remotes")
remotes::install_github("ruralinnovation/cori.data.fcc")
```


We recommend that you also pay attention to the release you are downloading as the package is under development.

TODO show how to get the version of a package 


## Pot. ideas

- Block covered BEAD like

- ISP networks

- Just download data

## Download files

- see above / could be that automated code is enough 


## Use CORI curated files

## Pot. discussions

place of business logic in data example bead category 

## Summary

- data as code:

  * enhance reproducibility 

  * easier to capitalize/build on it 


## References

TODO:

McBain (2024, March 11). Before I Sleep: Patterns and anti-patterns of data analysis reuse. Retrieved from https://milesmcbain.com/posts/data-analysis-reuse/

https://www.emilyriederer.com/post/team-of-packages/#collaboration


## Contacts

Website: [https://ruralinnovation.us](https://ruralinnovation.us)


[LinkedIn](https://www.linkedin.com/company/11099658) | [Twitter](https://twitter.com/Ruralinno) | [Facebook](https://www.facebook.com/RuralInno/) | [Instagram](https://www.instagram.com/ruralinno/) | [YouTube](https://www.youtube.com/channel/UCyqbtSrv4Nad9vVv4dQptcA) 
