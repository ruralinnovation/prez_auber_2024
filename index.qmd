---
title: "Working with Primary data"
subtitle: "`cori.data.fcc`:: an example of data as code"
author: "Olivier Leroy"
date: "October 20 2024"
institute: "Center On Rural Innovation"
fontsize: 20pt
favicon: assets/images/Logo-Mark_Black.png
format:
  revealjs: 
    theme: src/custom_cori.scss
    logo: img/CORI_Logo.png
    css: assets/fonts.css
    footnotes-hover:: true
from: markdown+emoji
editor: visual
---


## PLAN

* me & CORI

* FCC's Data



 
## Me

- I work as a senior data engineer

TODO: link to linkedin / mastodon / website 

data scientist : sexiest job 

data engineer : we are the plumber 
 
Data scientist; usually are on the business side and data engineer tend to be on the infrastructure side  

Working with primary data: distinction between something general and something business specific (I will give example later: downloading data is general, counting underseved location is business specific)  

## CORI

Center On Rural Innovation (CORI)

- one image (Doritos?)

-  why Data , open source and open data is important at CORI

# FCC's Data

## FCC TLDR

- FCC

- their data


## Previous workflow:

- What FCC data look like in the wild
- Our previous ingestion process
- Limits of it

ELT versus ETL and what that means for business perspective 

data as files data as tables and the limit 

(out of sync tables/files)

## Our needs

Connect humanity project / BEAD tool 

-> how do we produced that

Importance of using PG

## Manual v.s. ...

:::: {.columns}

::: {.column width="50%"}

![](img/manual_fcc.mov)


:::

::: {.column width="50%"}

* :repeat: Repeat for every state  
* :repeat: Repeat for every version  
* :red_circle: Error prone 

:::

::::


## ... Code Automated ...

:::: {.columns}

::: {.column width="50%"}

::: {.panel-tabset}

### Visual

![](img/dl_nbm_smaller.mov)

### Code

```{r}
#| label: example_dl_nbm
#| eval: false
#| echo: true
library(cori.data.fcc)

dir <- "data_swamp/nbm/"

get_nbm_release()

nbm_data <- get_nbm_available()

system(sprintf("mkdir -p %s", dir))

dl_nbm(
  path_to_dl = "data_swamp/nbm",
  release_date = "June 30, 2023",
  data_type = "Fixed Broadband",
  data_category = "Nationwide",
)

```

:::

:::

::: {.column width="50%"}

```{r}
#| label: check_dl_2
#| eval: false
#| echo: true
num_files <- get_nbm_available() |>
  dplyr::filter(release == "June 30, 2023" &
                data_type == "Fixed Broadband" &
                data_category == "Nationwide") |>
  nrow()

files_dl <- length(list.files(dir,
                              pattern = "*.zip"))

identical(num_files, files_dl)
# TRUE
```

:::

::::

## ... Code Packaged

# cori.data.fcc

## New technologies

- DuckDB and S3

  - takewaysa of those technology

- Parquet and interoperability 

skip PG here. 


## Packaging code and data

tl:dr R package / pkgdown / GH

- `?get_nbm_raw` 

- articles

- vignettes / mention of Emily R interbal package

- snipped of data-raw

- bandwagon pkg dev: test/website/check/distribution  

>  internally developed packages are [...] extra expert team members.[^dataanalysisreuse]

[^dataanalysisreuse]: https://milesmcbain.xyz/posts/data-analysis-reuse/

## why public

- open source is :

* a way to publish: ie you can read the code 

* a way to share: ie you can use it

We care more about process than product or to say it differently the product is just a mean to reach a goal (a process). We want to lower the cost of using that data so rural america can check what their isp are saying and challenge it and plan to get a better bb.




# Examples of uses cases

## How to get it: 

The source code is hosted on GitHub. 

You need the R packages remotes (or pak)

```{r}
#| eval: false
#| label: install-package
#| echo: true
 
install.packages("remotes")
remotes::install_github("ruralinnovation/cori.data.fcc")
```


We recommend that you also pay attention to the release you are downloading as the package is under development.

TODO show how to get the version of a package 


## Pot. ideas

- Block covered BEAD like

- ISP networks

- Just download data

## Download files

- see above / could be that automated code is enough 


## Use CORI curated files

## Pot. discussions

place of business logic in data example bead category 

## Summary

- data as code:

  * enhance reproducibility 

  * easier to capitalize/build on it 


## References

TODO:

McBain (2024, March 11). Before I Sleep: Patterns and anti-patterns of data analysis reuse. Retrieved from https://milesmcbain.com/posts/data-analysis-reuse/

https://www.emilyriederer.com/post/team-of-packages/#collaboration


## Contacts

Website: [https://ruralinnovation.us](https://ruralinnovation.us)


[LinkedIn](https://www.linkedin.com/company/11099658) | [Twitter](https://twitter.com/Ruralinno) | [Facebook](https://www.facebook.com/RuralInno/) | [Instagram](https://www.instagram.com/ruralinno/) | [YouTube](https://www.youtube.com/channel/UCyqbtSrv4Nad9vVv4dQptcA) 
